#summary How to segment Google Analytics reports by Website Optimizer experiment / version.

= Introduction =

This article explains how to send relevant Google Website Optimizer (GWO) events to Google Analytics (GA).  Once these events are in GA, you can use Advanced Segmentation to gain deeper insight as to how the users of your website change their behavior as a function of the experiments you are running.

= The code =

There are two steps to complete:

  * Tag the experiment page.
  * Tag the goal page.
  * Create the custom segments in GA.

===Tag the experiment page===

*If using ga.js*
{{{
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? " https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js ' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  //Pull the experiment variation - see notes in the article for options.
  var gwoVar = utmx("combination-string");
  if (!gwoVar) {
    gwoVar = "stopped";
  }

  //Get the pageTracker for your primary GA account.
  var firstTracker = _gat._getTracker("UA-xxxxx-x");
  firstTracker._initData();

  //Track the page view as normal.  
  //If you are tracking pages in a common footer, you can skip this step.
  firstTracker._trackPageview();

  //Track the GWO test event, where 1234567890 is the experiment id.
  firstTracker._trackPageview("/gwo/1234567890/test/" + gwoVar);

  //Get the pageTracker for your GWO account.
  var secondTracker = _gat._getTracker("UA-yyyyy-y");
  secondTracker._initData();

  //Track the GWO test event, where 1234567890 is the experiment id.
  secondTracker._trackPageview("/1234567890/test");
</script>
}}} 

*If using urchin.js*
{{{
<script>
  if(typeof(urchinTracker)!='function')document.write('<sc'+'ript src="'+
'http'+(document.location.protocol=='https:'?'s://ssl':'://www')+
'.google-analytics.com/urchin.js'+'"></sc'+'ript>')
</script>
<script>
  //Get _uacct for your primary GA account.
  _uacct = 'UA-xxxxx-x';

  //Track the page view as normal.  
  //If you are tracking pages in a common footer, you can skip this step.
  urchinTracker();


  //Track the GWO test event, where 1234567890 is the experiment id.
  urchinTracker("/zzzzzzzzzz/zzzz/" + utmx());

  //Get _uacct for your GWO account.
  _uacct = 'UA-yyyyy-y';

  //Track the GWO test event, where 1234567890 is the experiment id.
  urchinTracker("/zzzzzzzzzz/zzzz/");
</script>
}}}

These tags will add additional page views into your content report.  These page views essentially log relevant Website Optimizer events which occurred during the user's session.  The following table explains the events which are captured.

*For A/B experiments, or MV experiments with 1 section*

||*Page*||*Description*||
||/1234567890/test/||A visit to the test page with the test stopped or paused||
||/1234567890/test/0||A visit to the test page with original content||
||/1234567890/test/1||A visit to the test page with variation 1||
||/1234567890/test/2||A visit to the test page with variation 2 etc...||
||/1234567890/goal/||A visit to the goal page with the test stopped or paused||
||/1234567890/goal/0||A visit to the goal page with original content||
||/1234567890/goal/1||A visit to the goal page with variation 1||
||/1234567890/goal/2||A visit to the goal page with variation 2 etc...||

*For MV experiments with more than 1 section*

||*Page*||*Description*||
||/1234567890/test/||A visit to the test page with the test stopped or paused||
||/1234567890/test/0-0-0||A visit to the test page with original content||
||/1234567890/test/1-0-0||A visit to the test page with variation 1 of section 1, the original of section 2 and the original of section 3||
||/1234567890/test/2-1-3||A visit to the test page with variation 2 of section 1, variation 2 of section 2 and variation 3 of section 3 etc...||
||/1234567890/goal/||A visit to the goal page with the test stopped or paused||
||/1234567890/goal/0-0-0||A visit to the goal page with original content||
||/1234567890/goal/1-0-0||A visit to the goal page with variation 1 of section 1, the original of section 2 and the original of section 3||
||/1234567890/goal/2-1-3||A visit to the goal page with variation 2 of section 1, variation 2 of section 2 and variation 3 of section 3 etc...||

==Create the segments===

Once you have these additional page views in Google Analytics, it is possible to create custom segments.  Custom segments allow you to view your core reports, broken down by sessions which have included a Website Optimizer test.  Use the tool to create a segment for every Website Optimizer event you wish to track.  The image below explains the process.

http://wso-hacks.googlecode.com/files/segment-create.png